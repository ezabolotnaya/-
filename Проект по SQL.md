# –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å –∑–∞—Å—Ç–∞–ª –º–∏—Ä –≤—Ä–∞—Å–ø–ª–æ—Ö, –∏–∑–º–µ–Ω–∏–≤ –ø—Ä–∏–≤—ã—á–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤–µ—â–µ–π. –í —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏—Ç–µ–ª–∏ –≥–æ—Ä–æ–¥–æ–≤ –±–æ–ª—å—à–µ –Ω–µ –≤—ã—Ö–æ–¥—è—Ç –Ω–∞ —É–ª–∏—Ü—É, –Ω–µ –ø–æ—Å–µ—â–∞—é—Ç –∫–∞—Ñ–µ –∏ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã. –ó–∞—Ç–æ —Å—Ç–∞–ª–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –∫–Ω–∏–≥. –≠—Ç–æ –∑–∞–º–µ—Ç–∏–ª–∏ —Å—Ç–∞—Ä—Ç–∞–ø–µ—Ä—ã ‚Äî –∏ –±—Ä–æ—Å–∏–ª–∏—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç —á–∏—Ç–∞—Ç—å.


**–ó–∞–¥–∞—á–∞** ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

–í –Ω–µ–π ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–∞—Ö, –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞—Ö, –∞–≤—Ç–æ—Ä–∞—Ö, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–±–∑–æ—Ä—ã –∫–Ω–∏–≥. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–º–æ–≥—É—Ç —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.

# –û–ø–∏–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ books**

–°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–Ω–∏–≥–∞—Ö:
- *book_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–Ω–∏–≥–∏;
- *author_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∞;
- *title* ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏;
- *num_pages* ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü;
- *publication_date* ‚Äî –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–Ω–∏–≥–∏;
- *publisher_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑–¥–∞—Ç–µ–ª—è.

**–¢–∞–±–ª–∏—Ü–∞ authors**

–°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ–± –∞–≤—Ç–æ—Ä–∞—Ö:
- *author_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∞;
- *author* ‚Äî –∏–º—è –∞–≤—Ç–æ—Ä–∞.

**–¢–∞–±–ª–∏—Ü–∞ publishers**

–°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ–± –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞—Ö:

- *publisher_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞;
- *publisher* ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞;

**–¢–∞–±–ª–∏—Ü–∞ ratings**

–°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ—Ü–µ–Ω–∫–∞—Ö –∫–Ω–∏–≥:
- *rating_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ü–µ–Ω–∫–∏;
- *book_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–Ω–∏–≥–∏;
- *username* ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Å—Ç–∞–≤–∏–≤—à–µ–≥–æ –æ—Ü–µ–Ω–∫—É;
- *rating* ‚Äî –æ—Ü–µ–Ω–∫–∞ –∫–Ω–∏–≥–∏.

**–¢–∞–±–ª–∏—Ü–∞ reviews**

–°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–±–∑–æ—Ä–∞—Ö:
- *review_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±–∑–æ—Ä–∞;
- *book_id* ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–Ω–∏–≥–∏;
- *username* ‚Äî –∏–º—è –∞–≤—Ç–æ—Ä–∞ –æ–±–∑–æ—Ä–∞;
- *text* ‚Äî —Ç–µ–∫—Å—Ç –æ–±–∑–æ—Ä–∞.

## –í—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import pandas as pd
from sqlalchemy import text, create_engine
# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
db_config = {'user': 'praktikum_student', # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
'pwd': 'Sdf4$2;d-d30pp', # –ø–∞—Ä–æ–ª—å
'host': 'rc1b-wcoijxj3yxfsf3fs.mdb.yandexcloud.net',
'port': 6432, # –ø–æ—Ä—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
'db': 'data-analyst-final-project-db'} # –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
connection_string = 'postgresql://{user}:{pwd}@{host}:{port}/{db}'.format(**db_config)
# —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä
engine = create_engine(connection_string, connect_args={'sslmode':'require'})
# —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É–µ–º Pandas
query = '''SELECT * FROM books LIMIT 5'''
con=engine.connect()
pd.io.sql.read_sql(sql=text(query), con = con)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>book_id</th>
      <th>author_id</th>
      <th>title</th>
      <th>num_pages</th>
      <th>publication_date</th>
      <th>publisher_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>546</td>
      <td>'Salem's Lot</td>
      <td>594</td>
      <td>2005-11-01</td>
      <td>93</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>465</td>
      <td>1 000 Places to See Before You Die</td>
      <td>992</td>
      <td>2003-05-22</td>
      <td>336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>407</td>
      <td>13 Little Blue Envelopes (Little Blue Envelope...</td>
      <td>322</td>
      <td>2010-12-21</td>
      <td>135</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>82</td>
      <td>1491: New Revelations of the Americas Before C...</td>
      <td>541</td>
      <td>2006-10-10</td>
      <td>309</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>125</td>
      <td>1776</td>
      <td>386</td>
      <td>2006-07-04</td>
      <td>268</td>
    </tr>
  </tbody>
</table>
</div>




```python
def table_info(table):
 
    query = '''SELECT * FROM {} LIMIT 5'''.format(table)
    query_1 = '''SELECT COUNT (*) FROM {}'''.format(table)
    data = pd.io.sql.read_sql(query, con = engine)
    data_shape_table = pd.io.sql.read_sql(query_1, con = engine)
    display (data)
    display (data.info())
```


```python
list = ['books','authors', 'ratings', 'reviews', 'publishers']
for i in list:
    print ('\033[1m' + '–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', i)
    print('\033[0m')
    table_info(i)
```

    [1m–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è books
    [0m



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>book_id</th>
      <th>author_id</th>
      <th>title</th>
      <th>num_pages</th>
      <th>publication_date</th>
      <th>publisher_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>546</td>
      <td>'Salem's Lot</td>
      <td>594</td>
      <td>2005-11-01</td>
      <td>93</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>465</td>
      <td>1 000 Places to See Before You Die</td>
      <td>992</td>
      <td>2003-05-22</td>
      <td>336</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>407</td>
      <td>13 Little Blue Envelopes (Little Blue Envelope...</td>
      <td>322</td>
      <td>2010-12-21</td>
      <td>135</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>82</td>
      <td>1491: New Revelations of the Americas Before C...</td>
      <td>541</td>
      <td>2006-10-10</td>
      <td>309</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>125</td>
      <td>1776</td>
      <td>386</td>
      <td>2006-07-04</td>
      <td>268</td>
    </tr>
  </tbody>
</table>
</div>


    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 6 columns):
     #   Column            Non-Null Count  Dtype 
    ---  ------            --------------  ----- 
     0   book_id           5 non-null      int64 
     1   author_id         5 non-null      int64 
     2   title             5 non-null      object
     3   num_pages         5 non-null      int64 
     4   publication_date  5 non-null      object
     5   publisher_id      5 non-null      int64 
    dtypes: int64(4), object(2)
    memory usage: 368.0+ bytes



    None


    [1m–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è authors
    [0m



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>author_id</th>
      <th>author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A.S. Byatt</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Aesop/Laura Harris/Laura Gibbs</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Agatha Christie</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Alan Brennert</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Alan Moore/David   Lloyd</td>
    </tr>
  </tbody>
</table>
</div>


    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 2 columns):
     #   Column     Non-Null Count  Dtype 
    ---  ------     --------------  ----- 
     0   author_id  5 non-null      int64 
     1   author     5 non-null      object
    dtypes: int64(1), object(1)
    memory usage: 208.0+ bytes



    None


    [1m–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ratings
    [0m



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating_id</th>
      <th>book_id</th>
      <th>username</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>ryanfranco</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>grantpatricia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>brandtandrea</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2</td>
      <td>lorichen</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2</td>
      <td>mariokeller</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>


    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 4 columns):
     #   Column     Non-Null Count  Dtype 
    ---  ------     --------------  ----- 
     0   rating_id  5 non-null      int64 
     1   book_id    5 non-null      int64 
     2   username   5 non-null      object
     3   rating     5 non-null      int64 
    dtypes: int64(3), object(1)
    memory usage: 288.0+ bytes



    None


    [1m–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è reviews
    [0m



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review_id</th>
      <th>book_id</th>
      <th>username</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>brandtandrea</td>
      <td>Mention society tell send professor analysis. ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>ryanfranco</td>
      <td>Foot glass pretty audience hit themselves. Amo...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2</td>
      <td>lorichen</td>
      <td>Listen treat keep worry. Miss husband tax but ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>3</td>
      <td>johnsonamanda</td>
      <td>Finally month interesting blue could nature cu...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>3</td>
      <td>scotttamara</td>
      <td>Nation purpose heavy give wait song will. List...</td>
    </tr>
  </tbody>
</table>
</div>


    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 4 columns):
     #   Column     Non-Null Count  Dtype 
    ---  ------     --------------  ----- 
     0   review_id  5 non-null      int64 
     1   book_id    5 non-null      int64 
     2   username   5 non-null      object
     3   text       5 non-null      object
    dtypes: int64(2), object(2)
    memory usage: 288.0+ bytes



    None


    [1m–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è publishers
    [0m



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>publisher_id</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Ace</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Ace Book</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Ace Books</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Ace Hardcover</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Addison Wesley Publishing Company</td>
    </tr>
  </tbody>
</table>
</div>


    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 2 columns):
     #   Column        Non-Null Count  Dtype 
    ---  ------        --------------  ----- 
     0   publisher_id  5 non-null      int64 
     1   publisher     5 non-null      object
    dtypes: int64(1), object(1)
    memory usage: 208.0+ bytes



    None


–í—ã–≤–æ–¥: –≤—ã–≥—Ä—É–∑–∏–ª–∏ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∏—Ö.

## –ó–∞–¥–∞–Ω–∏–µ. –°–∫–æ–ª—å–∫–æ –∫–Ω–∏–≥ –≤—ã—à–ª–æ –ø–æ—Å–ª–µ 1 —è–Ω–≤–∞—Ä—è 2000 –≥–æ–¥–∞?


```python
query = '''


SELECT COUNT(*)
FROM books
WHERE CAST(publication_date AS TIMESTAMP)>=CAST('2000-01-01' AS TIMESTAMP)

'''
data = pd.io.sql.read_sql(query, con = engine)
print('–í—ã–≤–æ–¥: –ø–æ—Å–ª–µ 01 —è–Ω–≤–∞—Ä—è 2020 –≥–æ–¥–∞ –≤—ã—à–ª–æ {} –∫–Ω–∏–≥. '.format(data.loc[0, 'count']) )
```

    –í—ã–≤–æ–¥: –ø–æ—Å–ª–µ 01 —è–Ω–≤–∞—Ä—è 2020 –≥–æ–¥–∞ –≤—ã—à–ª–æ 821 –∫–Ω–∏–≥. 


## –ó–∞–¥–∞–Ω–∏–µ. –î–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –∏ —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É.


```python
query = '''


SELECT b.title,
       COUNT (DISTINCT re.review_id), ROUND (avg(r.rating), 2) AS R
FROM reviews AS re
RIGHT OUTER JOIN BOOKS AS b ON re.book_id=b.book_id
LEFT OUTER JOIN RATINGS AS r ON b.book_id = r.book_id
GROUP BY b.book_id
ORDER BY R DESC

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ù–∞–∑–≤–∞–Ω–∏–µ', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤', '–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥']
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1000 entries, 0 to 999
    Data columns (total 3 columns):
     #   Column              Non-Null Count  Dtype  
    ---  ------              --------------  -----  
     0   –ù–∞–∑–≤–∞–Ω–∏–µ            1000 non-null   object 
     1   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤  1000 non-null   int64  
     2   –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥     1000 non-null   float64
    dtypes: float64(1), int64(1), object(1)
    memory usage: 23.6+ KB



```python
data.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤</th>
      <th>–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arrows of the Queen (Heralds of Valdemar  #1)</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Walking Dead  Book One (The Walking Dead #...</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Light in August</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wherever You Go  There You Are: Mindfulness Me...</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Captivating: Unveiling the Mystery of a Woman'...</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tai-Pan (Asian Saga  #2)</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The Adventures of Tom Sawyer and Adventures of...</td>
      <td>1</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hard Times</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>A Fistful of Charms (The Hollows  #4)</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>In the Hand of the Goddess (Song of the Liones...</td>
      <td>2</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>



## –ó–∞–¥–∞–Ω–∏–µ. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–ø—É—Å—Ç–∏–ª–æ –Ω–∞–∏–±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ –∫–Ω–∏–≥ —Ç–æ–ª—â–µ 50 —Å—Ç—Ä–∞–Ω–∏—Ü ‚Äî —Ç–∞–∫ –≤—ã –∏—Å–∫–ª—é—á–∏—Ç–µ –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –±—Ä–æ—à—é—Ä—ã.


```python
query = '''


SELECT p.publisher,
       count(b.book_id)
FROM publishers AS p
JOIN BOOKS AS b ON p.publisher_id=b.publisher_id
WHERE b.num_pages > 50
GROUP BY p.publisher_id
ORDER BY count(b.book_id) DESC
LIMIT 1

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥']
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1 entries, 0 to 0
    Data columns (total 2 columns):
     #   Column                 Non-Null Count  Dtype 
    ---  ------                 --------------  ----- 
     0   –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞  1 non-null      object
     1   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥        1 non-null      int64 
    dtypes: int64(1), object(1)
    memory usage: 144.0+ bytes



```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Penguin Books</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div>



–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ "Penguin Books" **–≤—ã–ø—É—Å—Ç–∏–ª–æ 42 –∫–Ω–∏–≥–∏** —Ç–æ–ª—â–µ 50 —Å—Ç—Ä–∞–Ω–∏—Ü.

## –ó–∞–¥–∞–Ω–∏–µ. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–æ–π –∫–Ω–∏–≥, —É—á–∏—Ç—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –∫–Ω–∏–≥–∏ —Å 50 –∏ –±–æ–ª–µ–µ –æ—Ü–µ–Ω–∫–∞–º–∏.


```python
query = '''


SELECT a.author,
       AVG(r.rating) avg_rating
FROM authors AS a
JOIN books AS b ON a.author_id=b.author_id
JOIN ratings AS r ON b.book_id=r.book_id
WHERE b.book_id IN
    (SELECT b.book_id
     FROM books AS b
     JOIN ratings AS r ON b.book_id=r.book_id
     GROUP BY b.book_id
     HAVING count(r.rating_id)>=50)
GROUP BY a.author
ORDER BY avg_rating desc

LIMIT 1

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ê–≤—Ç–æ—Ä', '–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥']
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1 entries, 0 to 0
    Data columns (total 2 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   –ê–≤—Ç–æ—Ä            1 non-null      object 
     1   –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥  1 non-null      float64
    dtypes: float64(1), object(1)
    memory usage: 144.0+ bytes



```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ê–≤—Ç–æ—Ä</th>
      <th>–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>J.K. Rowling/Mary GrandPr√©</td>
      <td>4.287097</td>
    </tr>
  </tbody>
</table>
</div>



–ê–≤—Ç–æ—Ä—ã J.K. Rowling, Mary GrandPr√© —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–æ–π –∫–Ω–∏–≥, —É—á–∏—Ç—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –∫–Ω–∏–≥–∏ —Å 50 –∏ –±–æ–ª–µ–µ –æ—Ü–µ–Ω–∫–∞–º–∏, —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –∫–æ—Ç–æ—Ä—ã—Ö **4,3**.

## –ü–æ—Å—á–∏—Ç–∞–π—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –±–æ–ª—å—à–µ 48 –æ—Ü–µ–Ω–æ–∫.


```python
query = '''

WITH A AS
  (SELECT username,
          count(review_id)
   FROM reviews
   WHERE username IN
       (SELECT username
        FROM ratings
        GROUP BY username
        HAVING count(rating_id)>48)
   GROUP BY username)
SELECT ROUND (SUM (COUNT) / COUNT(COUNT), 2) AS AVG
FROM A

'''
data = pd.io.sql.read_sql(query, con = engine)
print ('–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –±–æ–ª—å—à–µ 48 –æ—Ü–µ–Ω–æ–∫: ', data.loc[0, 'avg'])
```

    –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –±–æ–ª—å—à–µ 48 –æ—Ü–µ–Ω–æ–∫:  24.0


**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ**

–ê) –í—ã–≤–µ–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ –≥–æ–¥—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:

- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤,
- –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –∏
- —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ç—ã—Å—è—á —Å—Ç—Ä–∞–Ω–∏—Ü –±—ã–ª–æ –≤ –∏–∑–¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö

(–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ –≥–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–¥–∞–Ω–æ –±–æ–ª–µ–µ 30 –∫–Ω–∏–≥)


```python
query = '''


SELECT EXTRACT (YEAR FROM publication_date) AS publication_year,
       COUNT (DISTINCT publisher_id) AS count_of_publisher,
       COUNT (*) AS count_of_books,
       SUM (num_pages) / 1000 AS sum_of_thousands_pages
FROM books
GROUP BY publication_year
HAVING COUNT(*) > 30
ORDER BY publication_year asc

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ì–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥', '–°—É–º–º–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö (—Ç—ã—Å.)']
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ì–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥</th>
      <th>–°—É–º–º–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö (—Ç—ã—Å.)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1999.0</td>
      <td>26</td>
      <td>41</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000.0</td>
      <td>35</td>
      <td>38</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2001.0</td>
      <td>41</td>
      <td>60</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2002.0</td>
      <td>62</td>
      <td>94</td>
      <td>38</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2003.0</td>
      <td>65</td>
      <td>105</td>
      <td>41</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2004.0</td>
      <td>88</td>
      <td>124</td>
      <td>46</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2005.0</td>
      <td>89</td>
      <td>139</td>
      <td>55</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2006.0</td>
      <td>109</td>
      <td>184</td>
      <td>68</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2007.0</td>
      <td>38</td>
      <td>50</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>



- –±–æ–ª–µ–µ 30 –∫–Ω–∏–≥ –±—ã–ª–æ –≤—ã–ø—É—â–µ–Ω–æ —Å 1999 –ø–æ 2007 –≥–≥.;
- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ (109) –±—ã–ª–æ –≤ 2006 –≥–æ–¥—É;
- –±–æ–ª–µ–µ 100 —Å–Ω–∏–≥ –±—ã–ª–æ –≤—ã–ø—É—â–µ–Ω–æ –≤ –ø–µ—Ä–∏–æ–¥ —Å 2003 –ø–æ 2006 –≥–≥.;
- —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–æ–∏–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö –±—ã–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.

–í 2007 –≥–æ–¥—É –∫–æ–ª–∏—á–µ–≤—Ç—Å–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å –±–æ–ª–µ–µ —á–µ–º –≤ 2 —Ä–∞–∑–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –≤ 3 —Ä–∞–∑–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–æ —Å—É–º–º–∞—Ä–Ω–æ 18 —Ç—ã—Å—è—á —Å—Ç—Ä–∞–Ω–∏—Ü.

–ë) –í—ã–≤–µ–¥–∏—Ç–µ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –¥–≤–∞ —á–∏—Å–ª–∞ ‚Äî —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É —Ç–µ—Ö –∫–Ω–∏–≥, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–ø–∏—Å–∞–ª–æ –æ—Ç–∑—ã–≤–æ–≤ –±–æ–ª–µ–µ 3 —á–µ–ª–æ–≤–µ–∫ –∏ –æ—Ç–¥–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–Ω–∏–≥, —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã –∫–∞–∫–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –±–æ–ª—å—à–µ


```python
query = '''


SELECT 
    ROUND (AVG(CASE WHEN count_of_review > 3 THEN avg_rating END),2) AS avg_rating_more_than_3_reviews,
    ROUND (AVG(CASE WHEN count_of_review <= 3 THEN avg_rating END),2) AS avg_rating_less_than_3_reviews
FROM
    (SELECT re.book_id,
            AVG(ra.rating) AS avg_rating,
            COUNT(review_id) AS count_of_review
    FROM reviews AS re
    JOIN books AS b ON re.book_id = b.book_id
    LEFT JOIN ratings AS ra ON b.book_id=ra.book_id
    GROUP BY re.book_id) AS avg_ra;

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ë–æ–ª–µ–µ 3 –æ—Ç–∑—ã–≤–æ–≤', '–ú–µ–Ω–µ–µ 3 –æ—Ç–∑—ã–≤–æ–≤']
print ('–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–Ω–∏–≥ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–∑—ã–≤–æ–≤')
data
```

    –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–Ω–∏–≥ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–∑—ã–≤–æ–≤





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ë–æ–ª–µ–µ 3 –æ—Ç–∑—ã–≤–æ–≤</th>
      <th>–ú–µ–Ω–µ–µ 3 –æ—Ç–∑—ã–≤–æ–≤</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.9</td>
      <td>3.82</td>
    </tr>
  </tbody>
</table>
</div>



–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–Ω–∏–≥ —Å –º–µ–Ω–µ–µ 3 –æ—Ç–∑—ã–≤–∞–º–∏ - 3,82, –∞ –∫–Ω–∏–≥–∏ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤ –±–æ–ª–µ–µ 3, —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 3,9.

–°–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–Ω–∏–≥–∏ —Å –æ—Ç–∑—ã–≤–∞–º–∏ –±–æ–ª–µ–µ 3 –∏–º–µ—é—Ç —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤—ã—à–µ, —á–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ.

–í) –í—ã–≤–µ–¥–∏—Ç–µ —Ç–æ–ø —Å–µ–º—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Å—É–º–º–∞—Ä–Ω–æ–º—É –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–µ–≤—å—é –∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫, —É–∫–∞–∑—ã–≤–∞—è —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∫–Ω–∏–≥–∞—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∏


```python
query = '''


SELECT ra.username,
       COUNT (re.review_id) AS count_of_reviews,
       SUM (ra.rating) AS sum_of_rating,
       SUM (b.num_pages) AS sum_of_pages
FROM ratings AS ra
JOIN reviews AS re ON ra.username=re.username
JOIN books AS b ON b.book_id=re.book_id
GROUP BY ra.username
ORDER BY (COUNT(re.review_id) + SUM(ra.rating)) DESC

LIMIT 7

'''
data = pd.io.sql.read_sql(query, con = engine)
data.columns = ['–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤', '–°—É–º–º–∞ –æ—Ü–µ–Ω–æ–∫', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∫–Ω–∏–Ω–∞—Ö']
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤</th>
      <th>–°—É–º–º–∞ –æ—Ü–µ–Ω–æ–∫</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∫–Ω–∏–Ω–∞—Ö</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sfitzgerald</td>
      <td>1540</td>
      <td>5908</td>
      <td>533500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>martinadam</td>
      <td>1512</td>
      <td>5724</td>
      <td>607600</td>
    </tr>
    <tr>
      <th>2</th>
      <td>susan85</td>
      <td>1421</td>
      <td>5394</td>
      <td>617645</td>
    </tr>
    <tr>
      <th>3</th>
      <td>richard89</td>
      <td>1430</td>
      <td>5226</td>
      <td>552420</td>
    </tr>
    <tr>
      <th>4</th>
      <td>jennifermiller</td>
      <td>1325</td>
      <td>5075</td>
      <td>479385</td>
    </tr>
    <tr>
      <th>5</th>
      <td>lesliegibbs</td>
      <td>1300</td>
      <td>4836</td>
      <td>492150</td>
    </tr>
    <tr>
      <th>6</th>
      <td>paul88</td>
      <td>1232</td>
      <td>4818</td>
      <td>440216</td>
    </tr>
  </tbody>
</table>
</div>



–í —Ç–∞–±–ª–∏—Ü–µ –≤—ã–≤–µ–¥–µ–Ω—ã –¢–û–ü-7 —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤ –æ—Å—Ç–∞–≤–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å sfitzgerald	 - 1540;
- —Å—É–º–º–∞ –æ—Ü–µ–Ω–æ–∫ –±–æ–ª—å—à–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è sfitzgerald - 5908;
- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–æ—á–∏—Ç–∞–ª –∏ –æ—Å—Ç–∞–≤–∏–ª –æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å susan85 - 617645.

## –û–±—â–∏–π –≤—ã–≤–æ–¥:

**–ó–∞–¥–∞—á–∞** ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

–í –Ω–µ–π ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–∞—Ö, –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞—Ö, –∞–≤—Ç–æ—Ä–∞—Ö, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–±–∑–æ—Ä—ã –∫–Ω–∏–≥. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–º–æ–≥—É—Ç —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.

- –ü–æ—Å–ª–µ 01 —è–Ω–≤–∞—Ä—è 2020 –≥. –≤—ã—à–ª–æ 821 –∫–Ω–∏–≥;
- –î–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏ (1000) –±—ã–ª–æ –ø—Ä–æ—Å—á–∏—Ç–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –∏ —Å—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞;
- –ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ "Penguin Books" –≤—ã–ø—É—Å—Ç–∏–ª–æ 42 –∫–Ω–∏–≥–∏ —Ç–æ–ª—â–µ 50 —Å—Ç—Ä–∞–Ω–∏—Ü;
- –ê–≤—Ç–æ—Ä—ã J.K. Rowling, Mary GrandPr√© —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Å—Ä–µ–¥–Ω–µ–π –æ—Ü–µ–Ω–∫–æ–π –∫–Ω–∏–≥, —É—á–∏—Ç—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –∫–Ω–∏–≥–∏ —Å 50 –∏ –±–æ–ª–µ–µ –æ—Ü–µ–Ω–∫–∞–º–∏, —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –∫–æ—Ç–æ—Ä—ã—Ö 4,3;
- –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–∑–æ—Ä–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –±–æ–ª—å—à–µ 48 –æ—Ü–µ–Ω–æ–∫:  24.

**–í—ã–≤–æ–¥—ã –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é.**

- –±–æ–ª–µ–µ 30 –∫–Ω–∏–≥ –±—ã–ª–æ –≤—ã–ø—É—â–µ–Ω–æ —Å 1999 –ø–æ 2007 –≥–≥.;
- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ (109) –±—ã–ª–æ –≤ 2006 –≥–æ–¥—É;
- –±–æ–ª–µ–µ 100 —Å–Ω–∏–≥ –±—ã–ª–æ –≤—ã–ø—É—â–µ–Ω–æ –≤ –ø–µ—Ä–∏–æ–¥ —Å 2003 –ø–æ 2006 –≥–≥.;
- —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–æ–∏–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö –±—ã–ª–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.

–í 2007 –≥–æ–¥—É –∫–æ–ª–∏—á–µ–≤—Ç—Å–æ –∏–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å –±–æ–ª–µ–µ —á–µ–º –≤ 2 —Ä–∞–∑–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –≤ 3 —Ä–∞–∑–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–æ —Å—É–º–º–∞—Ä–Ω–æ 18 —Ç—ã—Å—è—á —Å—Ç—Ä–∞–Ω–∏—Ü.

–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–Ω–∏–≥ —Å –º–µ–Ω–µ–µ 3 –æ—Ç–∑—ã–≤–∞–º–∏ - 3,82, –∞ –∫–Ω–∏–≥–∏ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–∑—ã–≤–æ–≤ –±–æ–ª–µ–µ 3, —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 3,9. –°–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–Ω–∏–≥–∏ —Å –æ—Ç–∑—ã–≤–∞–º–∏ –±–æ–ª–µ–µ 3 –∏–º–µ—é—Ç —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤—ã—à–µ, —á–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ.

–ë—ã–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¢–û–ü-7 —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤ –æ—Å—Ç–∞–≤–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å sfitzgerald	 - 1540;
- —Å—É–º–º–∞ –æ—Ü–µ–Ω–æ–∫ –±–æ–ª—å—à–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è sfitzgerald - 5908;
- –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–æ—á–∏—Ç–∞–ª –∏ –æ—Å—Ç–∞–≤–∏–ª –æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å susan85 - 617645.
